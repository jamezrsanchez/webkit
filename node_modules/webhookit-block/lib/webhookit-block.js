var filterKeys = require('filter-keys');



exports.run = function (params, cb) {
    
    
var patt = new RegExp(params.condition);    

//var result = patt.test(str);
console.log(patt);
var items = params.in;
var item = [];
//console.log(params);
//var sources = new Array();
//console.log(params.item);
for (var i = 0; i < items.length; i++) {
    var check = patt.test(items[i][params.item]);
    //console.log(items[i][params.item]);
    //console.log(check);
    if(check === false){
        item.push(items[i]);
        //console.log('out: '+ items[i][params.item])
    }
    
}
console.log(params);
cb({"out": item}); 


};



exports.definition = {
    "name": "block",
    "category": "Operators",
    "container": {
        "icon": "/images/module_icons/yql.png",
        "xtype": "WireIt.FormContainer",
        "title": "Block Filter",
        "fields": [
            {
                "type": "string",
                "name": "item",
                "wirable": false,
                label: "Item"
            },
            {
                "type": "string",
                "name": "condition",
                "wirable": false,
                label: "Condition"
            }

        ],
        "terminals": [
            {"name": "in", "direction": [0, -1], "offsetPosition": [75, -15], "ddConfig": {
                    "type": "input",
                    "allowedTypes": ["output"]
                },
                "nMaxWires": 1
            },
            {"name": "out", "direction": [0, 1], "offsetPosition": {"left": 75, "bottom": -15}, "ddConfig": {
                    "type": "output",
                    "allowedTypes": ["input"]
                }
            }
        ]
    }
};